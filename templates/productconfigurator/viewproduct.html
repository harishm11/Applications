{% extends 'body.html' %} {% load static %} {% load product_tags %} 
{% block title %} {{ title}}{% endblock %} 
{% load crispy_forms_tags%} 
{% block sidebarcontent %} 
{% include 'productconfigurator/sidebar.html' %} 
{%endblock %} 

{% block maincontent%} 
{% if request.user.is_authenticated %}

<div class="">
  <div class="row">
    <form
      method="get"
      action="{% url 'viewproduct'  %}"
      class="p-3"
    >
      <div class=input-group >
      <input type="text" name="search" value="{{ search_query }}" />
      <button class="btn btn-secondary" type="submit"><i class="fa fa-search"></i></button>
    </div>
    </form>
  </div>

  <div class="table-outer-div">
    <table class="table table-bordered table-responsive-sm custom-table">
      <thead>
        <tr> 
  
          {% for field in model_fields %} {% if field != 'id' and field != 'CreateTime' and field != 'UpdateTime'%}
          <th>{{ field }}
          {% endif %} {% endfor %}
  
        </tr>
      </thead>
      <tbody>
        {% for object in objects %}
        
        <tr>  
             
          {% for field in model_fields %} {% if field != 'id' and field != 'CreateTime' and field != 'UpdateTime'%}
          <td>{{ object|get_attribute:field }}</td>
          {% endif %} 
          {% endfor %}
          </tr>
 <tr>
          <td>
          <table class="table table-bordered table-responsive-sm custom-table">
          <thead>
              <tr> 
              <th>Coverage</th>
               <th>Option</th>
              </tr>
              </thead>
              <tbody>
              
                {% for coverage in object.coverages.all %}
                <tr>
                  <td>{{ coverage.CoverageName }}</td>
                   <td>{{ coverage.OptionValue }}</td>
                {% empty %}
                  <td>No coverages selected</td>
                  </tr>
                {% endfor %}
                 </tbody>
                 </table>
          </td>
</tr>
 <tr>
          <td>
          <table class="table table-bordered table-responsive-sm custom-table">
          <thead>
              <tr> 
              <th>Discounts</th>
               <th>Description</th>
              </tr>
              </thead>
              <tbody>
              
                {% for discount in object.discounts.all %}
                <tr>
                  <td>{{ discount.DiscountName }}</td>
                   <td>{{ discount.DiscountDesc }}</td>
                {% empty %}
                  <td>No discounts selected</td>
                  </tr>
                {% endfor %}
                 </tbody>
                 </table>
          </td>
 </tr>
 <tr>
          <td>
          <table class="table table-bordered table-responsive-sm custom-table">
          <thead>
              <tr> 
              <th>Surcharges</th>
               <th>Description</th>
              </tr>
              </thead>
              <tbody>
              
                {% for surcharge in object.surcharges.all %}
                <tr>
                  <td>{{ surcharge.SurchargeName }}</td>
                   <td>{{ surcharge.SurchargeDesc }}</td>
                {% empty %}
                  <td>No surcharges selected</td>
                  </tr>
                {% endfor %}
                 </tbody>
                 </table>
          </td>


        </tr>
        <tr> 
        <td>Update this Product?</td>
             <td>
            <a href="{% url 'updateproduct' product_id=object.pk %}"
              ><i class="fa fa-edit"></i
            ></a>
          </td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <nav aria-label="Page navigation">
      <ul class="pagination pagination-sm">
          {% if objects.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{ objects.previous_page_number }}">Previous</a></li>
          {% endif %}

          {% for num in objects.paginator.page_range %}
              {% if objects.number == num %}
                  <li class="page-item active"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% else %}
                  <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% endif %}
          {% endfor %}

          {% if objects.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ objects.next_page_number }}">Next</a></li>
          {% endif %}
      </ul>
    </nav>
</div>

{% endif %} {% endblock %} {% block js%} {% endblock js%}
